<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Outfit Planer</title>
  <style>
    body { font-family: sans-serif; margin: 1rem; }
    input, select, button { margin: 0.5rem 0; display: block; }
    .gallery, .canvas { display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 1rem; }
    .item { border: 1px solid #ccc; padding: 0.5rem; text-align: center; width: 100px; }
    img { max-width: 100%; height: auto; }
    .canvas { border-top: 2px solid #000; padding-top: 1rem; }
  </style>
</head>
<body>
  <h1>Outfit Planer</h1>
  <form id="uploadForm">
    <label>Foto des Kleidungsstücks: <input type="file" accept="image/*" required></label>
    <label>Kategorie: 
      <select required>
        <option value="">--Kategorie wählen--</option>
        <option value="Oberteil">Oberteil</option>
        <option value="Hose">Hose</option>
        <option value="Schuhe">Schuhe</option>
        <option value="Accessoire">Accessoire</option>
      </select>
    </label>
    <label>Farbe: <input type="text" placeholder="z.B. Blau" required></label>
    <button type="submit">Hinzufügen</button>
  </form>

  <h2>Kleidungsgalerie</h2>
  <div>
    <label>Filter: 
      <select id="filterCategory">
        <option value="">Alle Kategorien</option>
        <option value="Oberteil">Oberteil</option>
        <option value="Hose">Hose</option>
        <option value="Schuhe">Schuhe</option>
        <option value="Accessoire">Accessoire</option>
      </select>
    </label>
    <input type="text" id="filterColor" placeholder="Farbe filtern">
    <button onclick="renderGallery()">Anzeigen</button>
  </div>
  <div class="gallery" id="gallery"></div>

  <h2>Outfit-Zusammenstellung</h2>
  <div class="canvas" id="canvas"></div>
  <button onclick="saveOutfit()">Outfit speichern</button>

  <script>
    let clothes = JSON.parse(localStorage.getItem('clothes')) || [];
    let canvas = [];

    document.getElementById('uploadForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const fileInput = this.querySelector('input[type=file]');
      const category = this.querySelector('select').value;
      const color = this.querySelector('input[type=text]').value.trim();

      const reader = new FileReader();
      reader.onload = function(event) {
        clothes.push({ src: event.target.result, category, color });
        localStorage.setItem('clothes', JSON.stringify(clothes));
        renderGallery();
        fileInput.value = '';
      }
      if (fileInput.files[0]) reader.readAsDataURL(fileInput.files[0]);
    });

    function renderGallery() {
      const gallery = document.getElementById('gallery');
      gallery.innerHTML = '';
      const catFilter = document.getElementById('filterCategory').value;
      const colorFilter = document.getElementById('filterColor').value.trim().toLowerCase();

      clothes.filter(c => 
        (!catFilter || c.category === catFilter) &&
        (!colorFilter || c.color.toLowerCase().includes(colorFilter))
      ).forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `<img src="${item.src}" alt=""><div>${item.category} - ${item.color}</div>`;
        div.onclick = () => addToCanvas(index);
        gallery.appendChild(div);
      });
    }

    function addToCanvas(index) {
      canvas.push(clothes[index]);
      renderCanvas();
    }

    function renderCanvas() {
      const canvasDiv = document.getElementById('canvas');
      canvasDiv.innerHTML = '';
      canvas.forEach((item, i) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `<img src="${item.src}" alt=""><div>${item.category}</div>`;
        div.onclick = () => { canvas.splice(i, 1); renderCanvas(); };
        canvasDiv.appendChild(div);
      });
    }

    function saveOutfit() {
      let outfits = JSON.parse(localStorage.getItem('outfits')) || [];
      outfits.push(canvas);
      localStorage.setItem('outfits', JSON.stringify(outfits));
      alert('Outfit gespeichert!');
      canvas = [];
      renderCanvas();
    }

    renderGallery();
  </script>
</body>
</html>

